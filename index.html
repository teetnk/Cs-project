<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™‡πÅ‡∏Å‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î iOS</title>
    <script src="https://unpkg.com/@zxing/library@latest"></script>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; }
        video { width: 100%; height: auto; border: 2px solid black; }
        #result { font-size: 20px; margin-top: 10px; }
    </style>
</head>
<body>
    <h2>üì∏ ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î (iOS/Android)</h2>
    <video id="video"></video>
    <p id="result">üì¢ ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏™‡πÅ‡∏Å‡∏ô...</p>

    <script>
        const codeReader = new ZXing.BrowserBarcodeReader();
        const videoElement = document.getElementById('video');

        codeReader.decodeFromVideoDevice(undefined, videoElement, (result, err) => {
            if (result) {
                document.getElementById('result').innerText = "‚úÖ ‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î: " + result.text;

                // üìå ‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Apps Script
                fetch("https://script.google.com/macros/s/AKfycbwj1wiaXghK2TjpzXw0SWACC2t_VUuIlIXO4SwEOK_ngJJdCDUJZRp0egJeyIh66eLn/exec", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ barcode: result.text })
                }).then(response => response.text())
                  .then(data => console.log("üì§ Response:", data))
                  .catch(error => console.error("‚ùå Error:", error));
            }
        });

        // üìå ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏•‡πâ‡∏≠‡∏á
        navigator.mediaDevices.getUserMedia({ video: true })
            .then((stream) => { console.log("üì∑ ‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô"); })
            .catch((err) => { console.error("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á:", err); });
    </script>
</body>
</html>
